{% load staticfiles%}
<div class="row" style="margin-bottom: 10px;">
  <div class="col-lg-2">
    <div class="float:right">
      <h4><span class="label label-default">Year</span></h4>
    </div>
  </div>
  <div class="col-lg-10" style="width:80%">
    <div id="double_number_range"></div>
    <script>
    $("#double_number_range").rangepicker({
        type: "double",
        startValue: 2007,
        endValue: 2017,
        translateSelectLabel: function(currentPosition, totalPosition) {
            return 2007+parseInt(10 * (currentPosition / totalPosition));
        }
    });
    </script>
  </div>
</div>
<div class="row" style="margin-bottom: 10px;">
  <div class="col-lg-12">
    <h4><span class="label label-default">Category</span></h4>
    <div style="text-align:center;">
      {% for t in tags %}
        <button class="btn btn-sm btn-default" style="margin-bottom:3px;">
          <span class="text-uppercase">{{ t.0 }}</span>
          <!-- <span class="badge">{{ t.1 }}</span> -->
        </button>
      {% endfor %}
    </div>
  </div>
</div>
<div class="row">
  <div class="col-lg-12">
    <div style="max-height: 600px; overflow-x: hidden;">
      <table id="conflist" class="table table-hover">
      </table>
    </div>
  </div>
</div>
<script>
$('.btn').click(function(e) {
  var btn = $(this);
  btn.toggleClass('active');
  if (btn.hasClass('active')){
    btn.removeClass('btn-default');
    btn.addClass('btn-primary');
  } else {
    btn.removeClass('btn-primary');
    btn.addClass('btn-default');
  }
  e.preventDefault();

  var active = [];
  var buttons = document.getElementsByTagName('button');
  for (var i = 0; i < buttons.length; i++) {
    var button = buttons[i];
    if (button.classList.contains('active')) {
      active.push(button.innerText);
    }
  }

  if (active.length == 0) {
    $("#conflist tr").remove();
  } else {
    $.ajax({
      type: "POST",
      url: "/select",
      async: false,
      data: { keyword: active.join() },
      success: function (result) {
        var table = document.getElementById("conflist");
        $("#conflist tr").remove();
        for(var i in result) {
          var row = table.insertRow(i);
          var cell1 = row.insertCell(0);
          var cell2 = row.insertCell(1);
          cell1.innerHTML = result[i][0];
          cell2.innerHTML = result[i][1];
        }
      }
    });
  }
});
</script>
